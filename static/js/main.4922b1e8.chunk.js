(this["webpackJsonpmonlock-online-web"]=this["webpackJsonpmonlock-online-web"]||[]).push([[0],{136:function(e,t,n){},137:function(e,t,n){},145:function(e,t){},174:function(e,t,n){"use strict";n.r(t);var a=n(0),r=n.n(a),c=n(40),i=n.n(c),o=(n(136),n(137),n(93)),s=n.n(o),l=n(102),u=n(11),d=n(229),j=n(225),b=n(224),f=n(228),h=n(230),O=n(232),x=n(233),p=n(234),m=n(222),v=n(33),g=n(53),w=n.n(g),y=n(52),S=n.n(y),k=n(1);var C=function(e){var t=Object(a.useState)(""),n=Object(u.a)(t,2),r=n[0],c=n[1],i=Object(a.useState)(!1),o=Object(u.a)(i,2),s=o[0],l=o[1],j=Object(v.a)();return Object(k.jsx)(d.a,{display:"flex",justifyContent:"center",children:Object(k.jsx)(d.a,{display:"flex",flexDirection:"column",children:Object(k.jsxs)(d.a,{pt:50,children:[Object(k.jsx)(h.a,{variant:"h5",color:j.palette.text.primary,align:"center",mb:3,children:"Monlock"}),Object(k.jsxs)("form",{onSubmit:function(t){t.preventDefault(),e.onAuth(r)},children:[Object(k.jsx)(m.a,{margin:"normal",fullWidth:!0,name:"password",label:"\u041d\u0443\u0443\u0446 \u04af\u0433",type:s?"text":"password",id:"password",variant:"filled",onChange:function(e){return c(e.target.value)},InputProps:{endAdornment:Object(k.jsx)(O.a,{position:"end",children:Object(k.jsx)(x.a,{"aria-label":"toggle password visibility",onClick:function(){return l(!s)},onMouseDown:function(e){return e.preventDefault()},edge:"end",children:s?Object(k.jsx)(S.a,{}):Object(k.jsx)(w.a,{})})})}}),Object(k.jsx)(p.a,{type:"submit",fullWidth:!0,variant:"contained",sx:{mt:3,mb:2},children:"\u0422\u0430\u0439\u043b"})]})]})})})};var F=function(e){var t=Object(a.useState)(""),n=Object(u.a)(t,2),r=n[0],c=n[1],i=Object(a.useState)(!1),o=Object(u.a)(i,2),s=o[0],l=o[1],j=Object(v.a)();return Object(k.jsx)(d.a,{display:"flex",justifyContent:"center",children:Object(k.jsx)(d.a,{display:"flex",flexDirection:"column",children:Object(k.jsxs)(d.a,{pt:50,children:[Object(k.jsx)(h.a,{variant:"h5",color:j.palette.text.primary,align:"center",mb:3,children:"Monlock"}),Object(k.jsx)(d.a,{display:"flex",justifyContent:"center",children:Object(k.jsx)(h.a,{variant:"h7",color:j.palette.text.secondary,align:"center",children:"\u041d\u0443\u0443\u0446 \u0444\u0430\u0439\u043b new_encrypted_file.mag"})}),Object(k.jsxs)("form",{onSubmit:function(t){t.preventDefault(),e.onAuth(r)},children:[Object(k.jsx)(m.a,{margin:"normal",fullWidth:!0,name:"password",label:"\u041d\u0443\u0443\u0446 \u04af\u0433",type:s?"text":"password",id:"password",variant:"filled",onChange:function(e){return c(e.target.value)},InputProps:{endAdornment:Object(k.jsx)(O.a,{position:"end",children:Object(k.jsx)(x.a,{"aria-label":"toggle password visibility",onClick:function(){return l(!s)},onMouseDown:function(e){return e.preventDefault()},edge:"end",children:s?Object(k.jsx)(S.a,{}):Object(k.jsx)(w.a,{})})})}}),Object(k.jsx)(p.a,{type:"submit",fullWidth:!0,variant:"contained",sx:{mt:3,mb:2},children:"\u041d\u044d\u0432\u0442\u0440\u044d\u0445"})]})]})})})},D=n(36),T=n.n(D);function E(e){for(var t="",n="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789",a=n.length,r=0;r<e;r++)t+=n.charAt(Math.floor(Math.random()*a));return t}var I=n(226),L=n(67),A=n(108),N=n(221),B=n(30),H=n.n(B);var M=function(e){var t=e.onFocusChange,n=e.secrets,r=e.onSelect,c=Object(a.useRef)(null);return Object(a.useEffect)((function(){c&&c.current.focus()}),[c]),Object(k.jsx)(N.a,{freeSolo:!0,id:"free-solo-2-demo",getOptionLabel:function(e){return"".concat(e.name)},options:n,onChange:function(e,t){r(t.id)},filterOptions:function(e,t){return function(e,t){return e.filter((function(e){if(e.name.toLowerCase().includes(t))return!0;if(e.username&&e.username.toLowerCase().includes(t))return!0;if(e.url&&e.url.toLowerCase().includes(t))return!0;if(H.a.isArray(e.additFields)){var n,a=Object(A.a)(e.additFields);try{for(a.s();!(n=a.n()).done;)if(n.value.fieldName.toLowerCase().includes(t))return!0}catch(r){a.e(r)}finally{a.f()}}return!1}))}(e,t.inputValue)},renderOption:function(e,t){return Object(k.jsx)(d.a,Object(L.a)(Object(L.a)({component:"li",sx:{"& > img":{mr:2,flexShrink:0}}},e),{},{children:Object(k.jsxs)(d.a,{display:"flex",flexDirection:"column",children:[Object(k.jsx)(d.a,{children:Object(k.jsx)(h.a,{variant:"subtitle2",children:t.name})}),Object(k.jsx)(d.a,{children:Object(k.jsx)(h.a,{variant:"caption",children:t.username})})]})}))},renderInput:function(e){return Object(k.jsx)(m.a,Object(L.a)(Object(L.a)({onFocus:function(){return t(!0)},onBlur:function(){return t(!1)}},e),{},{label:"\u0425\u0430\u0439\u0445 \u0442\u0430\u043b\u0431\u0430\u0440",inputRef:c}))}})},P=n(235),z=n(236),W=n(237);var U=function(e){var t=e.title,n=e.subTitle,a=e.id,r=e.onClick;return Object(k.jsx)(d.a,{mt:1,children:Object(k.jsx)(P.a,{children:Object(k.jsx)(z.a,{onClick:function(){return r(a)},children:Object(k.jsxs)(W.a,{children:[Object(k.jsx)(h.a,{gutterBottom:!0,variant:"h7",component:"div",children:t}),Object(k.jsx)(h.a,{variant:"p",color:"text.secondary",children:n})]})})})})};var _=function(e){var t=e.secrets,n=e.onItemSelect;return Object(k.jsx)(k.Fragment,{children:t.map((function(e){return Object(k.jsx)(U,{title:e.name,subTitle:e.username,id:e.id,onClick:n},e.id)}))})},J=n(110),K=n.n(J),R=n(238),V=n(109);var q=function(e){var t=e.fieldName,n=e.val,r=e.hidden,c=e.link,i=Object(a.useState)(!1),o=Object(u.a)(i,2),s=o[0],l=o[1],j=Object(v.a)(),b=!0===r,f=!0===c;return Object(k.jsxs)(d.a,{mt:5,display:"flex",style:{width:"100%",display:"grid",gridTemplateColumns:"auto 1fr",gridGap:10},children:[Object(k.jsxs)(d.a,{children:[Object(k.jsx)(d.a,{children:Object(k.jsx)(h.a,{variant:"subtitle1",color:j.palette.text.primary,style:{wordBreak:"break-word"},children:t})}),Object(k.jsx)(d.a,{children:f?Object(k.jsx)(R.a,{href:n,target:"_blank",children:n}):Object(k.jsx)(h.a,{variant:"h7",color:j.palette.text.secondary,style:{wordBreak:"break-word"},children:b?s?n:"*********":n})})]}),Object(k.jsxs)(d.a,{display:"flex",pt:2,children:[b?Object(k.jsx)(d.a,{children:Object(k.jsx)(x.a,{"aria-label":"toggle password visibility",onClick:function(){return l(!s)},onMouseDown:function(e){return e.preventDefault()},edge:"end",children:s?Object(k.jsx)(S.a,{}):Object(k.jsx)(w.a,{})})}):null,Object(k.jsx)(d.a,{ml:4,pr:2,children:Object(k.jsx)(V.CopyToClipboard,{text:n,children:Object(k.jsx)(x.a,{edge:"end",children:Object(k.jsx)(K.a,{})})})})]})]})};var G=function(e){var t=e.secret,n=!!t.password&&H.a.isString(t.password),a=!!t.url&&H.a.isString(t.url),r=!!t.username&&H.a.isString(t.username),c=Object(v.a)(),i=H.a.get(t,"additFields",[]);return H.a.isArray(i)||(i=[]),Object(k.jsxs)(d.a,{mt:6,children:[Object(k.jsx)(h.a,{variant:"h6",color:c.palette.text.primary,children:t.name}),a?Object(k.jsx)(q,{fieldName:"URL",val:t.url,link:!0}):null,r?Object(k.jsx)(q,{fieldName:"Username",val:t.username}):null,n?Object(k.jsx)(q,{fieldName:"Password",val:t.password,hidden:!0}):null,i.map((function(e,t,n){return Object(k.jsx)(q,{fieldName:e.fieldName,val:e.value,hidden:!0},t)}))]})},Y=n(112),Q=n.n(Y),X=n(111),Z=n.n(X),$=n(77),ee=n(78),te=function(){function e(t){var n=t.timeout,a=t.onTimeout;Object($.a)(this,e),this.timeout=n,this.onTimeout=a,this.eventHandler=this.updateExpiredTime.bind(this),this.tracker(),this.startInterval()}return Object(ee.a)(e,[{key:"startInterval",value:function(){var e=this;this.updateExpiredTime(),this.interval=setInterval((function(){var t=localStorage.getItem("_expiredTime"),n=Number(t);isNaN(n)&&e.onTimeout(),n<Date.now()&&e.onTimeout()}),1e3)}},{key:"updateExpiredTime",value:function(){localStorage.setItem("_expiredTime",Date.now()+1e3*this.timeout)}},{key:"tracker",value:function(){window.addEventListener("mousemove",this.eventHandler),window.addEventListener("scroll",this.eventHandler),window.addEventListener("keydown",this.eventHandler)}},{key:"cleanUp",value:function(){clearInterval(this.interval),window.removeEventListener("mousemove",this.eventHandler),window.removeEventListener("scroll",this.eventHandler),window.removeEventListener("keydown",this.eventHandler)}}]),e}();var ne=function(e){var t=Object(a.useState)("list"),n=Object(u.a)(t,2),r=n[0],c=n[1],i=Object(a.useState)(null),o=Object(u.a)(i,2),s=o[0],l=o[1],j=Object(v.a)();Object(a.useEffect)((function(){var t=new te({timeout:40,onTimeout:function(){console.log("time out"),e.onLogout()}});return function(){t.cleanUp()}}),[]);var b=H.a.get(e,"mainData.data.secrets",[]),h=function(t){e.setSearchFocus(!1),c("detail");var n=b.find((function(e){return e.id===t}));n&&l(n)};return Object(k.jsxs)(d.a,{pt:6,children:[Object(k.jsxs)(d.a,{pb:3,children:[Object(k.jsxs)(d.a,{display:"flex",children:["detail"===r?Object(k.jsx)(d.a,{mr:2,children:Object(k.jsx)(x.a,{onClick:function(){return c("list")},children:Object(k.jsx)(Z.a,{})})}):null,Object(k.jsx)(p.a,{onClick:function(t){return e.setSearchFocus(!0)},fullWidth:!0,variant:"outlined",children:"\u0425\u0430\u0439\u0445"}),Object(k.jsx)(d.a,{ml:2,children:Object(k.jsx)(x.a,{onClick:function(){return e.onLogout()},onMouseDown:function(e){return e.preventDefault()},children:Object(k.jsx)(Q.a,{})})})]}),e.searchFocus?Object(k.jsx)(I.a,{sx:{zIndex:function(e){return e.zIndex.drawer+1}},style:{background:"rgb(0 0 0 / 52%)",backdropFilter:"blur(5px)",WebkitBackdropFilter:"blur(5px)",alignItems:"flex-start",paddingTop:j.spacing(8)},open:e.searchFocus,children:Object(k.jsx)(f.a,{children:Object(k.jsx)(d.a,{px:7,children:Object(k.jsx)(M,{onFocusChange:function(t){return e.setSearchFocus(t)},secrets:b,onSelect:h})})})}):null]}),Object(k.jsxs)(d.a,{style:{height:"calc(100vh - 87px)",overflowY:"auto"},children:["list"===r?Object(k.jsx)(_,{secrets:b,onItemSelect:h}):null,"detail"===r?Object(k.jsx)(G,{secret:s}):null]})]})},ae=n(239);var re=function(){return Object(k.jsx)(I.a,{sx:{color:"#fff",zIndex:function(e){return e.zIndex.drawer+1}},open:!0,children:Object(k.jsx)(ae.a,{})})};var ce=function(){var e=Object(a.useState)(!1),t=Object(u.a)(e,2),n=t[0],r=t[1],c=Object(a.useState)(1),i=Object(u.a)(c,2),o=i[0],h=i[1],O=Object(a.useState)(!1),x=Object(u.a)(O,2),p=x[0],m=x[1],g=Object(a.useState)(""),w=Object(u.a)(g,2),y=w[0],S=w[1],D=Object(a.useState)(!1),I=Object(u.a)(D,2),L=I[0],A=I[1],N=Object(a.useState)(null),B=Object(u.a)(N,2),H=B[0],M=B[1],P=Object(v.a)();function z(e){3===o&&e.ctrlKey&&"KeyF"===e.code&&e.shiftKey&&(e.preventDefault(),r(!0))}Object(a.useEffect)((function(){document.addEventListener("keydown",z,!1)}),[]);var W=function(e){var t=T.a.SHA256(e);return T.a.enc.Base64.stringify(t)},U=function(){var e=Object(l.a)(s.a.mark((function e(t,n){var a,r,c;return s.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return a={hash:t},n&&(a.hash2=n,a.step2=!0),e.next=4,fetch("".concat("https://2cqhopp1d8.execute-api.ap-southeast-1.amazonaws.com/Prod","/monlock_action"),{method:"POST",headers:{Accept:"application/json","Content-Type":"application/json"},body:JSON.stringify(a)});case 4:return r=e.sent,e.next=7,r.json();case 7:return c=e.sent,e.abrupt("return",c);case 9:case"end":return e.stop()}}),e)})));return function(t,n){return e.apply(this,arguments)}}();return Object(k.jsx)(d.a,{bgcolor:P.palette.background.default,children:Object(k.jsxs)(f.a,{component:"main",children:[Object(k.jsxs)(d.a,{style:{height:"100vh"},children:[1===o?Object(k.jsx)(C,{onAuth:function(e){var t=W(e),n=T.a.AES.encrypt("".concat(t,"\u2191").concat(E(5),"\u2191").concat((new Date).getTime()),"9wdff0j203j4nf02234f23f").toString();S(n),A(!0),U(n).then((function(e){e.isValid?h(o+1):m(!0),A(!1)})).catch((function(e){m(!0),A(!1)}))}}):null,2===o?Object(k.jsx)(F,{onAuth:function(e){var t=W(e),n=T.a.AES.encrypt("".concat(t,"\u2191").concat(E(5),"\u2191").concat((new Date).getTime()),"9wdff0j203j4nf02234f23f");A(!0),U(y,n.toString()).then((function(e){if(e.isValid){h(o+1);var n=T.a.enc.Base64.parse(t).toString(T.a.enc.Hex).substr(0,20),a=null,r=T.a.AES.decrypt(e.data,n);try{a=JSON.parse(r.toString(T.a.enc.Utf8))}catch(i){}var c=function(e){var t={secrets:[],folders:[]};try{e[3].forEach((function(e){var n={id:e[0],name:e[1],url:0===e[2]?void 0:e[2],username:0===e[3]?void 0:e[3],password:0===e[4]?void 0:e[4],additFields:[],folderID:e[6]};0!==e[5]&&e[5].forEach((function(e){n.additFields.push({fieldName:e[0],value:e[1]})})),t.secrets.push(n)})),e[4].forEach((function(e){t.folders.push({id:e[0],name:e[1],secrets:[]})}))}catch(i){return{data:t}}return{data:t,stamp:e[0]}}(a);M(c)}else m(!0);A(!1)})).catch((function(e){m(!0),A(!1)}))}}):null,3===o?Object(k.jsx)(ne,{mainData:H,onLogout:function(){h(1),S(""),M(null)},searchFocus:n,setSearchFocus:r}):null]}),L?Object(k.jsx)(re,{}):null,Object(k.jsx)(j.a,{anchorOrigin:{vertical:"top",horizontal:"center"},open:p,onClose:function(){return m(!1)},children:Object(k.jsx)(b.a,{onClose:function(){return m(!1)},severity:"warning",sx:{width:"100%"},children:"\u0410\u043b\u0434\u0430\u0430 \u0433\u0430\u0440\u043b\u0430\u0430!"})})]})})},ie=n(113),oe=n(227);var se=function(){var e=Object(ie.a)({spacing:4,palette:{mode:"dark"}});return Object(k.jsx)(oe.a,{theme:e,children:Object(k.jsx)(ce,{})})},le=function(e){e&&e instanceof Function&&n.e(3).then(n.bind(null,240)).then((function(t){var n=t.getCLS,a=t.getFID,r=t.getFCP,c=t.getLCP,i=t.getTTFB;n(e),a(e),r(e),c(e),i(e)}))};i.a.render(Object(k.jsx)(r.a.StrictMode,{children:Object(k.jsx)(se,{})}),document.getElementById("root")),le()}},[[174,1,2]]]);
//# sourceMappingURL=main.4922b1e8.chunk.js.map